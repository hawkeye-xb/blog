---
title: 浏览器渲染过程
date: 2024-06-15
draft: true
---

从服务端获取HTML Doc之后。
 - 开始进行HTML解析
 - 检测到CSS 样式节点
 - 同时开始Style解析
 - 得到Dom Tree和CSS Tree之后
 - 合并成渲染树
 - 渲染
	- 布局Layout：技术元素在页面的位置、大小。（布局或者重排）
		- 分层（Layering）：在布局（Layout）/重排（Reflow）之后，浏览器会根据元素的属性（如transform、opacity、z-index等）和启发式算法决定哪些元素应该被提升为单独的图层。这个分层决策通常在绘制（Paint）之前完成，因为图层的划分会影响绘制的范围和顺序。分层的结果是一系列独立的图层，每个图层包含了应该在屏幕上显示的元素和它们的样式信息。
	- 绘制到屏幕上（Paint）：元素的颜色、边框、阴影等。（绘制或者重绘）。输出的结果是bitmap位图。
	- 合成：在所有相关的图层都绘制完成后，浏览器会将这些图层合成为最终的页面。
		- 维护合成层能够隔离重排和重绘。
		- 相应的会需要更大的内存（空间换时间）。管理图层过多合成时候也费劲。	
		- 合成层通常是基于以下规则创建的：
			- 使用3D变换（如translate3d、scale3d等）的元素。
			- 使用will-change属性指定的元素。
			- 使用video、canvas、webgl等元素。
			- 具有z-index的元素，如果它们与其他元素重叠。（怎么说）
